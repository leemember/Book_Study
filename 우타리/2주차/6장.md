# 6장 타입스크립트 컴파일

## 1. 런타임과 컴파일타임

- 고수준 언어 : 사람이 이해하기 쉬운 형식으로 작성 ex) Javascript, Typesciprt
- 저수준 : 컴퓨터가 이해하기 쉬운 형식을 작성 ex) 컴파일러, 인터프리터

### (1) 컴파일타임 : 컴퓨터가 인식할 수 있도록

- 소스코드 ⇒ 기계어 코드

소스코드의 컴파일이 완료되면 **프로그램이 메모리에 적재되어 실행**되는데 이 시간을 **런타임**이라고 부른다.

즉, **런타임은** 컴파일과정을 마친 응용 프로그램이 **사용자에 의해 실행되는 과정**을 말한다.

### (2) 런타임

- 자바스크립트가 실행되는 환경을 의미
- **대표적인 런타임**
    - 크롬, 사파리와같은 인터넷 브라우저와 Node.js
    - 자바스크립트 엔진, 웹 API, 콜백 큐, 이벤트루프, 렌더 큐

에러 발생 사례가 애플리케이션 실행 도중 발생하는 이유는 **런타임에서 자바스크립트 에러 발생**으로 인함

자바스크립트는 인터프리터 언어로 별도의 컴파일 과정이 존재하지 않는다.

고로, 자바스크립트를 해석하고 실행하는 역할을 하는 **V8 엔진**은 자바스크립트 코드를 **최적화하기 위해 컴파일 단계**를 거친다. 

***V8 엔진이란?** 웹 브라우저를 만드는 데 기반을 제공하는 오픈 소스 자바스크립트 엔진으로 구글 크롬 브라우저와 안드로이드 브라우저에 탑재되어있다.

### 추가적으로 알아본 각 웹 브라우저의 엔진들

![1F](https://github.com/leemember/Book_Study/assets/71499150/a8137950-ff37-4e73-9690-ff6acdfff441)

이 과정들은 실행 속도를 향상하기 위한 목적으로 자바스크립트 코드를 캐싱하여 이후 실행 시간을 단축시킨다.

## ⭐️ 타입스크립트의 컴파일러 ⭐️

<img width="916" alt="image" src="https://github.com/leemember/Book_Study/assets/71499150/211b058f-e941-44b2-aad2-8f1473c365b9">


**Typescript ⇒ tsc 컴파일러 ⇒ 자바스크립트 코드** (고수준 언어가 또 다른 고수준 언어로 변환)

타입스크립트의 컴파일 과정을 **트랜스파일**이라고 부르기도 하고 **소스 대 소스 컴파일러**라고 지칭하기도 함

- 트랜스파일의 예시
    - ES6 버전 이상의 문법을 ES5 버전 이하의 문법으로 변환해주는 **바벨(Babel)**
    - 타입스크립트 → 자바스크립트

```markup
**🟣 컴파일** : 고수준 언어 ---> 저수준 언어
🟣 **트랜스파일** : 고수준 언어 ---> 또 다른 고수준 언어
```

***바벨이란?**

ECMAScript 2015 이후 코드를 현재 또는 오래된 브라우저와 호환되는 버전으로 변환해주는 자바스크립트 컴파일러이다.

ex) 최신 문법인 옵셔널체이닝 `?.` , 화살표함수 `() ⇒`  등등의 문법들을 구버전 브라우저에서도 호환 가능하도록 해줌 → 폴리필의 역할

### 변환과정을 살펴보자 ‼️

![tsc-program-to-ast](https://github.com/leemember/Book_Study/assets/71499150/3e3f2cc6-29a7-4276-8101-710d3fd24aee)


***AST란?** 컴파일러가 소스코드를 해석하는 과정에서 생성된 데이터 구조다. 
컴파일러는 어휘적 분석과 구문 분석을 통해 소스코드를 노드 단위의 트리 구조로 구성한다.

1. **컴파일러**는 타입스크립트 소스코드를 해석하여 **AST** (Abstact Syntax Tree 최소구문트리)로 만든다.
2. 타입 검사기가 AST를 확인하여 타입을 확인한다.
3. 타입스크립트 AST → 자바스크립트 소스로 변환한다.
4. `런타임` 변환된 js 코드를 js AST로 만든다.
5. `런타임` AST가 바이트 코드로 변환된다.
6. `런타임` 런타임에서 바이트 코드가 평가되어 프로그램이 실행된다.

TS 코드예시)

```jsx
function add(a:number, b:number) {
  return a + b;
}

abb(10,20);
abb(10, "20") // 😡 이런 경우 에러가 발생한다.
```

타입스크립트는 **컴파일타임**에 타입을 검사하기 때문에 **에러가 발생하면 프로그램이 실행되지 않는다.**
이러한 특징 때문에 타입스크립트를 컴파일타임에 에러를 발견할 수 있는 **정적 타입 검사기**라고 부른다. 

**‼️ 즉, 컴파일타임에 문법 에러랑 타입 관련 에러를 모두 검출**

**하지만** 타입 오류가 있더라도 일단 컴파일을 진행해준다.

ts 코드가 js 코드로 변환되는 과정은 타입 검사와 **독립적으로 동작**하기 때문이다.

ts 코드의 타이핑이 잘못되어 발생하는 에러는 js 실행과정에서 **런타임 에러로 처리** 해준다.

### 요약

- 최신 버전 언어인 TS를 JS 코드로 트랜스파일
- 코드의 타입 오류를 검사해준다.
